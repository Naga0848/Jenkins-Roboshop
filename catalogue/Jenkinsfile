pipeline {
    agent {
        label 'AGENT-1'
    }
     environment { 
        appVersion = ''
     }
    stages {
        stage('Read package.json') {
            steps {
                script {
                    // Defensive check: confirm file exists
                    if (!fileExists('package.json')) {
                    echo "DEBUG: Current directory is $(pwd)"
                    sh 'ls -la'
                    error "package.json not found in workspace. Please check your repo and Jenkinsfile location."
                     }
                    // Read and extract version
                    def packageJson = readJSON file: 'package.json'
                    def appVersion = packageJson.version
                    echo "âœ… Package version: ${appVersion}"
                }
            }
        }
        stage('Test') {
            steps {
                echo 'Testing..'
            }
        }
        stage('Deploy') {
            steps {
                echo 'Deploying....'
            }
        }
    }
}